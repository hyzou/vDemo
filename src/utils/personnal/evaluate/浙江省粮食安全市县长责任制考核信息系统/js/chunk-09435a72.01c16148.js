(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-09435a72"],{"0d6f":function(e,t,a){"use strict";t.a={selfScore:[{required:!0,message:"自评分不能为空",trigger:"blur"}],selfName:[{required:!0,message:"填报人不能为空",trigger:"blur"}],checkName:[{required:!0,message:"审核人不能为空",trigger:"blur"}],reduceScore:[{required:!0,message:"是否减分不能为空",trigger:"blur"}],reason:[{required:!0,message:"减分原因不能为空",trigger:"blur"}]}},2999:function(e){e.exports=[{type:"inputHidden",label:"数据id",name:"assessmentId",span:24,width:"150px"},{type:"input",label:"年度",name:"year",span:12,width:"150px",disabled:!0},{type:"input",label:"城市",name:"cityName",span:12,width:"150px",disabled:!0},{type:"input",label:"考核内容",name:"assessmentContent",span:24,width:"150px",disabled:!0},{type:"input",label:"重点考核事项",name:"assessmentItems",span:24,width:"150px",disabled:!0},{type:"input",label:"考核目标",name:"assessmentTarget",span:24,width:"150px",disabled:!0},{type:"input",label:"年度考核目标任务",name:"assessmentTargetTask",span:24,width:"150px",disabled:!0},{type:"textarea",label:"评分标准",name:"scoreStandard",span:24,width:"150px",disabled:!0,rows:4},{type:"select",label:"责任处室",name:"officeLeadDepartmentId",span:12,multiple:!1,placeHolder:"请选择",filterable:!1,width:"150px",data:[{label:"杭州市商务局储备监管处",value:"1003002"}]},{type:"select",label:"配合处室",name:"officeCoordinationDepartmentId",span:12,multiple:!1,placeHolder:"请选择",filterable:!1,width:"150px",data:[{label:"杭州市农业农村局农田建设管理处",value:"1002001"}]}]},"2f50":function(e){e.exports=[{flag:"search",size:"",icon:"",label:"立即查找",styleType:"primary",postUrl:"addRegisterMember"},{flag:"reset",size:"",icon:"",label:"清  除",styleType:"",postUrl:"addRegisterMember"}]},"30c5":function(e){e.exports=[{prop:"status",propType:"statusDot",lable:"状态",width:"50px"},{prop:"assessmentTarget",lable:"年度考核目标任务"},{prop:"scoreStandard",lable:"评分标准"},{prop:"targetScore",lable:"分值",width:"70px"},{prop:"selfScore",lable:"自评分",width:"70px"},{prop:"reason",lable:"减分原因"},{prop:"measures",lable:"整改措施"},{prop:"cityLeadDepartment",lable:"市牵头部门"},{prop:"cityCoordinationDepartment",lable:"市配合部门"},{prop:"officeLeadDepartment",lable:"责任处室"},{prop:"operateBtns",lable:"操作",propType:"operateBtns",width:"150px"}]},"5c25":function(e){e.exports=[{type:"select",label:"考核内容",name:"assessmentContent",span:8,width:"150px",data:[{label:"目标1",value:"targetId1"},{label:"目标2",value:"targetId2"},{label:"目标3",value:"targetId3"}]},{type:"select",label:"重点考核事项",name:"assessmentItems",span:8,width:"150px",data:[{label:"目标1",value:"targetId1"},{label:"目标2",value:"targetId2"},{label:"目标3",value:"targetId3"}]},{type:"select",label:"考核指标",name:"assessmentTarget",span:8,width:"150px",data:[{label:"目标1",value:"targetId1"},{label:"目标2",value:"targetId2"},{label:"目标3",value:"targetId3"}]},{type:"select",label:"年度考核目标任务",name:"assessmentTargetTask",span:8,width:"150px",data:[{label:"目标1",value:"targetId1"},{label:"目标2",value:"targetId2"},{label:"目标3",value:"targetId3"}]},{type:"select",label:"完成状态",name:"status",span:8,width:"150px",data:[{label:"已完成",value:"complete"},{label:"未完成",value:"incomplete"},{label:"已上报",value:"reported"}]},{type:"select",label:"是否失分",name:"reduceScore",span:8,width:"150px",data:[{label:"是",value:"Y"},{label:"否",value:"N"}]}]},6251:function(e){e.exports=[{type:"inputHidden",label:"数据id",name:"assessmentId",span:24,width:"150px"},{type:"input",label:"年度",name:"year",span:12,width:"150px",disabled:!0},{type:"input",label:"城市",name:"cityName",span:12,width:"150px",disabled:!0},{type:"input",label:"考核内容",name:"assessmentContent",span:24,width:"150px",disabled:!0},{type:"input",label:"重点考核事项",name:"assessmentItems",span:24,width:"150px",disabled:!0},{type:"input",label:"考核目标",name:"assessmentTarget",span:24,width:"150px",disabled:!0},{type:"input",label:"年度考核目标任务",name:"assessmentTargetTask",span:24,width:"150px",disabled:!0},{type:"textarea",label:"评分标准",name:"scoreStandard",span:24,width:"150px",disabled:!0,rows:4},{type:"inputTable",label:"配合工作情况",name:"coordinationList",span:24,width:"150px",headers:[{key:"coordination",title:"配合部门",disabled:!0},{key:"coordinationOpinions",title:"配合部门意见",disabled:!0},{key:"coordinationMaterials",title:"配合材料",disabled:!0}],tableItems:{coordination:"",coordinationOpinions:"",coordinationMaterials:""}},{type:"input",label:"指标分数",name:"targetScore",span:12,width:"150px",disabled:!0},{type:"input",label:"自评分",name:"selfScore",span:12,width:"150px"},{type:"upload",label:"打分依据",name:"scoreBasis",span:24,width:"150px",choseBtn:"上传文件"},{type:"radio",label:"是否减分",name:"reduceScore",span:12,width:"150px",linkName:"reduceScoreHandle",data:[{label:"否",value:"N"},{label:"是",value:"Y"}]},{type:"elTreeSelect",label:"自评单位",name:"selfOrgName",span:12,width:"150px",disabled:!0,props:{value:"orgId",label:"orgName",children:"children",choseOnlyLeaf:!1},data:[]},{type:"textarea",hideItem:!0,label:"减分原因",name:"reason",span:24,width:"150px"},{type:"textarea",label:"整改措施",name:"measures",span:24,width:"150px",rows:3},{type:"input",label:"自评人",name:"selfName",span:12,width:"150px"},{type:"input",label:"审核人",name:"checkName",span:12,width:"150px"}]},6881:function(e){e.exports=[{flag:"cancle",label:"取消",styleType:""},{flag:"save",label:"保存",styleType:"primary"}]},"69e8":function(e){e.exports=[{flag:"cancle",label:"取消",styleType:""},{flag:"save",label:"保存",styleType:"primary"}]},"70e3":function(e,t,a){"use strict";t.a={officeLeadDepartmentId:[{required:!0,message:"责任处室不能为空",trigger:"blur"}],officeCoordinationDepartmentId:[{required:!0,message:"配合处室不能为空",trigger:"blur"}]}},c8b8:function(e,t,a){"use strict";a.r(t);a("8e6e"),a("456d"),a("ac6a");var s=a("bd86"),i=(a("7f7f"),a("5c25")),n=a("2f50"),r=a("2999"),l=a("69e8"),o=a("30c5"),p=a("6251"),d=a("6881"),m=a("0d6f"),c=a("70e3"),u=a("e776"),g=a("452f");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}var b={name:"index",components:{formGroup:u.a,Status:g.a},data:function(){return{totalScore:0,totalSelfScore:0,suggestSetFormItems:{fullScreen:!1,formGroupList:i,formGroupValues:{},formButtonList:n},tableSettings:{tableDatas:[],tableSettingOptions:{ref:"target",tooltipEffect:"dark",rowKey:"assessmentId",border:!0,headerOptions:o,isShowIndex:!0,showIndexHeader:"序号"}},paginationSettings:{currentPage:1,layout:"total, prev, pager, next, jumper",totalNumbers:0},dialogFormSettingsDistribute:{dialogFormVisible:!1,dialogFormTitle:"分配",dialogType:"form",dialogFormItems:{formGroupList:r,formGroupValues:{},formButtonList:l,rules:c.a}},dialogFormSettingsSelfEvaluation:{dialogFormVisible:!1,dialogFormTitle:"自评打分",dialogType:"form",width:"70%",dialogFormItems:{formGroupList:p,formGroupValues:{reduceScore:"N"},formButtonList:d,rules:m.a}}}},methods:{handleSearchFormBtn:function(e,t){console.log(e,t)},handleTableRowButton:function(e,t){if("distribute"===t.type)this.dialogFormSettingsDistribute.dialogFormVisible=!0,this.dialogFormSettingsDistribute.dialogFormItems.formGroupList.map(function(e){return"officeLeadDepartmentId"===e.name&&(e.hideItem=!1),"officeCoordinationDepartmentId"===e.name&&(e.hideItem=!0,e.data=[]),e}),this.dialogFormSettingsDistribute.dialogFormItems.formGroupValues=e;else if("self"===t.type){var a=this.$store.getters["assessment/getAssessmentResult"];if(e.cityCoordinationDepartmentId){if(!(a[e.assessmentId]&&a[e.assessmentId].cityOpinion&&a[e.assessmentId].cityOpinion.opinion))return void this.$message({message:"配合部门未完成意见填写,无法自评!",type:"warning"});if(a[e.assessmentId].cityOpinion){var s=a[e.assessmentId].cityOpinion;e.coordinationList=[],e.coordinationList.push({coordination:e.cityCoordinationDepartment,coordinationOpinions:s.opinion,coordinationMaterials:s.materials}),this.startOfficeSelf(e)}}else this.startOfficeSelf(e)}},startOfficeSelf:function(e){var t=this;this.dialogFormSettingsSelfEvaluation.dialogFormVisible=!0,this.dialogFormSettingsSelfEvaluation.dialogFormItems.formGroupValues={},this.dialogFormSettingsSelfEvaluation.dialogFormItems.formGroupList.map(function(e){return"selfOrgName"===e.name&&(e.data=t.$store.getters["user/orgTree"]),e}),e.selfOrgName=this.$store.getters["user/userInfos"].userId,console.log(e);var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach(function(t){Object(s.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e,{reduceScore:e.reduceScore||"N"});this.linkSelect("reduceScoreHandle",e.reduceScore),this.dialogFormSettingsSelfEvaluation.dialogFormItems.formGroupValues=a},linkSelect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"N";"reduceScoreHandle"===e&&("Y"===t?this.dialogFormSettingsSelfEvaluation.dialogFormItems.formGroupList.map(function(e){return"reason"===e.name&&(e.hideItem=!1),e}):this.dialogFormSettingsSelfEvaluation.dialogFormItems.formGroupList.map(function(e){return"reason"===e.name&&(e.hideItem=!0),e}))},handleDialogFormDistribute:function(e,t){var a=this;(this.dialogFormSettingsDistribute.dialogFormVisible=!1,"save"===e.flag)&&this.tableSettings.tableDatas.forEach(function(e){if(e.assessmentId===t.assessmentId){var s=a.$store.getters["user/userIdForName"];e.officeLeadDepartment=s[t.officeLeadDepartmentId],e.officeLeadDepartmentId=t.officeLeadDepartmentId,e=Object.assign({},e,t),a.$store.dispatch("assessment/commitAssessmentInfo",e).then(function(){a.setTableList()})}})},handlePaginationPagenumber:function(){},handleDialogFormSelfEvaluation:function(e,t){var a=this,s=this;this.dialogFormSettingsSelfEvaluation.dialogFormVisible=!1,t.assessmentId&&this.$confirm("确认提交给考核办？提交后数据不能修改","提交",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(e){console.log(e),a.$store.getters["assessment/getAssessmentList"].forEach(function(e){e.assessmentId===t.assessmentId&&(e.selfScore=t.selfScore,e.scoreBasis=t.scoreBasis,e.reason=t.reason,e.measures=t.measures,e.reduceScore=t.reduceScore,a.$store.dispatch("assessment/commitAssessmentInfo",e))}),a.$store.dispatch("assessment/commitAssessmentResult",{formData:t,action:"citySelf"}).then(function(){s.$message({message:"数据提交成功",type:"success"}),a.setTableList()})}).catch()},handleSizeChange:function(){},setTableList:function(){var e=this;this.totalScore=0,this.totalSelfScore=0;var t=this.$store.getters["user/userInfos"].userId,a=JSON.parse(JSON.stringify(this.$store.getters["assessment/getAssessmentList"])),s=this.$store.getters["assessment/getAssessmentResult"];this.tableSettings.tableDatas=[],a.forEach(function(a){a.operateBtns=[],a.cityLeadDepartmentId&&a.cityLeadDepartmentId==t&&(e.totalScore+=parseFloat(a.targetScore,2),e.totalSelfScore+=parseFloat(a.selfScore?a.selfScore:0,2),s[a.assessmentId]&&s[a.assessmentId].citySelf&&s[a.assessmentId].citySelf.selfScore?a.status="complete":a.selfScore&&!s[a.assessmentId]?a.status="complete":(a.operateBtns.push({styleType:"primary",type:"self",text:"自评"}),a.officeLeadDepartmentId||a.operateBtns.push({styleType:"primary",type:"distribute",text:"分配"}),a.status="incomplete"),e.tableSettings.tableDatas.push(a))}),this.paginationSettings.totalNumbers=this.tableSettings.tableDatas.length}},mounted:function(){this.setTableList();var e=this.$store.getters["assessment/getAssessmentList"],t=this.suggestSetFormItems.formGroupList;this.suggestSetFormItems.formGroupList=this.$globalFnc.setFilterFormData(e,JSON.parse(JSON.stringify(t)))}},h=a("2877"),S=Object(h.a)(b,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pt10 pr10 pl10 width100"},[a("el-col",{staticClass:"mb20",attrs:{span:24}},[a("commonTitleWithBorder",{attrs:{title:"查询条件"}})],1),a("el-col",{staticClass:"mb20",attrs:{span:24}},[a("formGroup",{attrs:{formGroupSettings:e.suggestSetFormItems},on:{formGroupSubmit:e.handleSearchFormBtn}})],1),a("el-row",{staticClass:"mb10"},[a("el-col",{attrs:{span:6}},[a("commonTitleWithBorder",{attrs:{title:"列表信息"}})],1)],1),a("el-col",{staticClass:"lheight40",attrs:{span:24}},[e._v("\n    状态提醒："),a("Status",{attrs:{status:"incomplete"}}),e._v("未完成\n    "),a("Status",{staticClass:"ml10",attrs:{status:"complete"}}),e._v("已完成\n    "),a("span",{staticClass:"ml20"},[e._v("\n      评分点分值合计 ("+e._s(e._f("toDecimal2")(e.totalScore))+") 分，自评分共计(\n      "+e._s(e._f("toDecimal2")(e.totalSelfScore))+"\n      )分\n    ")])],1),a("tableList",{attrs:{tablelistSettings:e.tableSettings},on:{handleTableRowButton:e.handleTableRowButton}}),a("pagination",{attrs:{paginationSettings:e.paginationSettings},on:{handlePaginationPagenumber:e.handlePaginationPagenumber,handlePaginationPagesize:e.handleSizeChange}}),e.dialogFormSettingsDistribute.dialogFormVisible?a("dialogForm",{attrs:{dialogFormSettings:e.dialogFormSettingsDistribute},on:{handleDialogForm:e.handleDialogFormDistribute}}):e._e(),e.dialogFormSettingsSelfEvaluation.dialogFormVisible?a("dialogForm",{attrs:{dialogFormSettings:e.dialogFormSettingsSelfEvaluation},on:{handleDialogForm:e.handleDialogFormSelfEvaluation,linkSelect:e.linkSelect}}):e._e()],1)},[],!1,null,"e19ff808",null);t.default=S.exports}}]);